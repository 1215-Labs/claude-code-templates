{
  "description": "LSP-aware hooks for code quality validation and persistent memory",
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Edit",
        "hooks": [
          {
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/hooks/lsp-reference-checker.py",
            "timeout": 30000
          }
        ]
      },
      {
        "matcher": "Edit|Write|MultiEdit",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Before applying this file change, scan the content for security anti-patterns:\n- Command injection: user input passed to exec(), spawn(), system(), or backticks\n- XSS: unsanitized user input rendered in HTML/JSX without escaping\n- SQL injection: string concatenation in SQL queries instead of parameterized queries\n- eval/Function constructor: dynamic code execution from untrusted input\n- Path traversal: user input in file paths without sanitization\n- Hardcoded secrets: API keys, passwords, tokens, or private keys in source code\n- Insecure deserialization: JSON.parse or yaml.load on untrusted input without validation\n\nIf any of these patterns are detected, BLOCK the edit and explain the vulnerability with a safe alternative. If the code is safe, allow it silently."
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Edit",
        "hooks": [
          {
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/hooks/lsp-type-validator.py",
            "timeout": 60000
          }
        ]
      }
    ],
    "SessionStart": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/hooks/session-init.py",
            "timeout": 10000
          },
          {
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/hooks/memory-loader.py",
            "timeout": 10000
          },
          {
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/hooks/skill-router-loader.py",
            "timeout": 5000
          }
        ],
        "once": true
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Before stopping, verify the task is complete: all requested changes made, no pending todos, and code compiles without errors. If incomplete, explain what remains."
          },
          {
            "type": "prompt",
            "prompt": "Review this session for memory-worthy information. If there are new facts, preferences, decisions, or learnings worth persisting, write them to the appropriate memory files:\n\n- User preferences/identity → ~/.claude/memory/user-profile.md\n- Communication style → ~/.claude/memory/voice.md\n- Tool/environment info → ~/.claude/memory/tool-environment.md\n- Project architecture/conventions → .claude/memory/project-context.md\n- Architectural decisions (use DEC-NNN format) → .claude/memory/decisions.md\n- Tasks/TODOs for next session → .claude/memory/tasks.md\n\nAlso write a brief session summary to .claude/memory/sessions/ with filename format YYYY-MM-DD_HHMM.md containing:\n- ## Summary (2-3 sentences of what was accomplished)\n- ## Key Changes (bullet list of files/features changed)\n- ## Open Items (anything left unfinished)\n- ## Next Session (one sentence: what to tackle next time)\n\nRules:\n- Do NOT store secrets (API keys, passwords, tokens, private keys)\n- Do NOT duplicate entries that already exist in memory files\n- Only store genuinely useful information, not trivial details\n- If nothing worth remembering happened, skip memory writes entirely\n- Append to existing sections with timestamp prefix: - [YYYY-MM-DD] content"
          },
          {
            "type": "command",
            "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/uncommitted-check.sh",
            "timeout": 5000
          }
        ]
      }
    ],
    "SessionEnd": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/hooks/memory-distill.py",
            "timeout": 5000
          },
          {
            "type": "command",
            "command": "python3 ${CLAUDE_PLUGIN_ROOT}/hooks/session-summary.py",
            "timeout": 5000
          }
        ]
      }
    ],
    "SubagentStop": [
      {
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Verify the subagent completed its assigned task. Check that the output addresses the original request and contains actionable results. If the subagent failed or returned incomplete results, note what is missing."
          }
        ]
      }
    ],
    "PreCompact": [
      {
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Before compacting context, preserve these critical items in your summary:\n- Current task objective and progress\n- Key decisions made and their rationale\n- File paths and line numbers being actively worked on\n- Any unresolved errors or blockers\n- User preferences expressed during this session"
          }
        ]
      }
    ],
    "UserPromptSubmit": [],
    "Notification": []
  }
}
